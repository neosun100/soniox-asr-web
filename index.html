<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soniox ASR 服务</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }
        .tab {
            padding: 12px 24px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            transition: all 0.3s;
            border-radius: 8px 8px 0 0;
        }
        .tab:hover {
            background: rgba(255,255,255,1);
            color: #000;
        }
        .tab.active {
            background: rgba(255,255,255,0.95);
            color: #4CAF50;
            border-bottom-color: #4CAF50;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🎙️ Soniox ASR 服务</h1>
        </header>

        <div class="config-section">
            <h2>⚙️ 配置</h2>
            <div class="form-group">
                <label for="apiKey">API Keys:</label>
                <input type="password" id="apiKey" placeholder="输入 API Keys（多个用逗号分隔）">
                <button id="toggleKeyBtn" class="btn-small">👁️ 显示</button>
            </div>
            <p class="hint">💡 支持多个 API Key（用逗号分隔），系统将自动负载均衡</p>
            <div class="privacy-notice">
                <span class="privacy-icon">🔒</span>
                <span class="privacy-text">您的 API Key 仅存储在浏览器本地，永不上传服务器</span>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('rest')">📁 REST API 批量上传</button>
            <button class="tab" onclick="switchTab('websocket')">⚡ WebSocket 快速转录</button>
        </div>

        <!-- REST API Tab -->
        <div id="rest-tab" class="tab-content active">
            <div class="main-content">
                <div class="controls">
                    <h2>📁 批量文件上传</h2>
                    
                    <div class="info-box">
                        <p>💡 <strong>批量上传：</strong>支持拖拽多个文件，最多 100 个</p>
                        <p>🎬 <strong>视频支持：</strong>自动提取视频文件中的音频进行转录</p>
                        <p>⚡ <strong>智能并行：</strong>可调节并行度，避免 API 限流</p>
                        <p>📏 <strong>自动切分：</strong>单文件最长 5 小时，超出自动切分并合并</p>
                        <p>⏰ <strong>处理时间：</strong>通常 1-3 分钟/文件</p>
                    </div>
                    
                    <div class="options">
                        <label class="switch">
                            <input type="checkbox" id="uploadEnableDiarization" checked>
                            <span class="slider"></span>
                            <span class="label-text">人声分离</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="restLanguageId">
                            <span class="slider"></span>
                            <span class="label-text">语言标注</span>
                        </label>
                        <span class="hint" style="color: #6c757d; font-size: 12px; margin-left: 10px;">
                            示例: <span style="color: #059669; font-weight: 600; background: #e8f5e9; padding: 2px 6px; border-radius: 3px;">[EN] Hello</span> 
                            <span style="color: #2563eb; font-weight: 600; background: #e3f2fd; padding: 2px 6px; border-radius: 3px;">[ZH] 你好</span>
                        </span>
                        <div class="concurrency-control">
                            <label for="concurrencyLimit">并行度</label>
                            <input type="number" id="concurrencyLimit" min="1" max="20" value="5">
                            <span class="hint-text">同时处理任务数</span>
                        </div>
                    </div>

                    <!-- 模型和语言选择 -->
                    <div class="model-language-section" style="margin: 15px 0; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px;">
                        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                            <div class="form-group" style="flex: 1; min-width: 200px;">
                                <label for="restModel" style="color: white; margin-bottom: 5px; display: block;">模型选择:</label>
                                <select id="restModel" class="lang-select" style="width: 100%; padding: 8px; border-radius: 6px;">
                                    <option value="stt-async-v4">stt-async-v4 (推荐)</option>
                                </select>
                            </div>
                            <div class="form-group" style="flex: 1; min-width: 300px;">
                                <label style="color: white; margin-bottom: 5px; display: block;">语言提示:</label>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; background: rgba(255,255,255,0.2); padding: 10px; border-radius: 6px;">
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="zh" checked>
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">中文</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="en" checked>
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">英语</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="ja">
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">日语</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="ko">
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">韩语</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="es">
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">西班牙语</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="fr">
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">法语</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="de">
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">德语</span>
                                    </label>
                                    <label class="switch" style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="rest-lang-hint" value="ru">
                                        <span class="slider"></span>
                                        <span class="label-text" style="font-size: 13px;">俄语</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 音频处理选项 -->
                    <div class="audio-processing-section">
                        <h3>🎚️ 音频处理选项</h3>
                        <div class="privacy-notice-small">
                            <span class="privacy-icon">🔒</span>
                            <span class="privacy-text">所有音视频处理在浏览器本地完成，不上传服务器</span>
                        </div>
                        <div class="processing-options">
                            <label class="switch">
                                <input type="checkbox" id="enableNoiseReduction">
                                <span class="slider"></span>
                                <span class="label-text">启用降噪（去除背景噪音）</span>
                            </label>
                            
                            <div class="speed-control">
                                <label class="switch">
                                    <input type="checkbox" id="enableSpeedChange">
                                    <span class="slider"></span>
                                    <span class="label-text">启用变速</span>
                                </label>
                                <div class="speed-options" id="speedOptions" style="display: none;">
                                    <label class="radio-label">
                                        <input type="radio" name="speedRate" value="1.25">
                                        <span>1.25x</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="speedRate" value="1.5" checked>
                                        <span>1.5x</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="speedRate" value="1.75">
                                        <span>1.75x</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="speedRate" value="2.0">
                                        <span>2.0x</span>
                                    </label>
                                </div>
                                <p class="warning-text">⚠️ 注意：变速会改变音调</p>
                            </div>
                        </div>
                    </div>

                    <div id="dropZone" class="drop-zone">
                        <div class="drop-zone-content">
                            <p>📎 拖拽文件到这里</p>
                            <p>或</p>
                            <button id="selectFilesBtn" class="btn btn-primary">选择文件</button>
                            <input type="file" id="fileInput" accept="audio/*,video/*" multiple style="display: none;">
                        </div>
                    </div>

                    <div id="fileList" class="file-list"></div>
                    
                    <div id="processingStatus" class="processing-status" style="display: none;">
                        <h4>处理进度</h4>
                        <p>已完成: <span id="currentProcessing">0</span> / <span id="totalFiles">0</span> (<span id="progressPercent">0</span>%)</p>
                        <p>并行任务数: <span id="concurrency">0</span></p>
                        <div class="progress-bar">
                            <div id="progressBar" class="progress-fill">
                                <span class="progress-text">0%</span>
                            </div>
                        </div>
                    </div>

                    <button id="uploadBtn" class="btn btn-primary" style="display: none;">开始转录</button>
                    <button id="clearBtn" class="btn btn-danger" style="display: none;">清空列表</button>
                </div>

                <div class="transcript-box">
                    <h3>转录结果</h3>
                    <div id="resultTabs" class="result-tabs"></div>
                    <div id="uploadTranscript"></div>
                    <div class="download-options" id="downloadOptions" style="display: none; margin-top: 15px;">
                        <label style="color: #333; margin-right: 10px;">导出格式:</label>
                        <select id="exportFormat" style="padding: 8px; border-radius: 6px; margin-right: 15px;">
                            <option value="txt">TXT 纯文本</option>
                            <option value="srt">SRT 字幕</option>
                            <option value="vtt">VTT 字幕</option>
                        </select>
                        <button id="downloadBtn" class="btn btn-success">下载当前结果</button>
                        <button id="downloadAllBtn" class="btn btn-success">下载全部结果</button>
                    </div>
                </div>

                <div class="log-box">
                    <h3>📋 处理日志 <button id="clearLogBtn" class="btn-small">清空</button></h3>
                    <div id="logContent"></div>
                </div>
            </div>
        </div>

        <!-- WebSocket Tab -->
        <div id="websocket-tab" class="tab-content">
            <div class="main-content">
                <div class="controls">
                    <h2>⚡ 实时语音识别 + 翻译</h2>
                    
                    <div class="info-box">
                        <p>⚡ <strong>实时识别：</strong>支持 60+ 种语言自动识别</p>
                        <p>🌐 <strong>实时翻译：</strong>支持单向/双向翻译</p>
                        <p>💡 <strong>多人对话：</strong>自动识别不同说话人</p>
                    </div>

                    <div class="options">
                        <label class="switch">
                            <input type="checkbox" id="wsDiarization" checked>
                            <span class="slider"></span>
                            <span class="label-text">人声分离</span>
                        </label>
                        
                        <label class="switch">
                            <input type="checkbox" id="wsLanguageId" checked>
                            <span class="slider"></span>
                            <span class="label-text">语言标注</span>
                        </label>
                        
                        <label class="switch">
                            <input type="checkbox" id="wsLanguageStrict">
                            <span class="slider"></span>
                            <span class="label-text">严格语言模式</span>
                        </label>
                        
                        <div class="concurrency-control">
                            <label for="maxEndpointDelay">端点延迟</label>
                            <input type="number" id="maxEndpointDelay" min="500" max="3000" value="2000" step="100">
                            <span class="hint-text">ms (500-3000)</span>
                        </div>
                        
                        <span class="hint" style="color: rgba(255,255,255,0.9); font-size: 12px; margin-left: 10px;">
                            示例: <span style="color: #4CAF50; font-weight: 600; background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 3px;">[EN] Hello</span> 
                            <span style="color: #64B5F6; font-weight: 600; background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 3px;">[ZH] 你好</span>
                        </span>
                    </div>

                    <div class="translation-section">
                        <h4>🌐 翻译设置</h4>
                        
                        <div class="translation-mode">
                            <label class="radio-option">
                                <input type="radio" name="translationType" value="none" checked>
                                <span class="radio-label">不翻译</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="translationType" value="one_way">
                                <span class="radio-label">单向翻译</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="translationType" value="two_way">
                                <span class="radio-label">双向翻译</span>
                            </label>
                        </div>
                        <div id="oneWayOptions" class="translation-options" style="display: none;">
                            <label class="select-label">目标语言:</label>
                            <select id="targetLang" class="lang-select">
                                <option value="zh">中文 (zh)</option>
                                <option value="en">英语 (en)</option>
                                <option value="es">西班牙语 (es)</option>
                                <option value="fr">法语 (fr)</option>
                                <option value="de">德语 (de)</option>
                                <option value="ja">日语 (ja)</option>
                                <option value="ko">韩语 (ko)</option>
                                <option value="ar">阿拉伯语 (ar)</option>
                                <option value="ru">俄语 (ru)</option>
                                <option value="pt">葡萄牙语 (pt)</option>
                                <option value="it">意大利语 (it)</option>
                                <option value="nl">荷兰语 (nl)</option>
                                <option value="pl">波兰语 (pl)</option>
                                <option value="tr">土耳其语 (tr)</option>
                                <option value="vi">越南语 (vi)</option>
                                <option value="th">泰语 (th)</option>
                                <option value="id">印尼语 (id)</option>
                                <option value="hi">印地语 (hi)</option>
                                <option value="uk">乌克兰语 (uk)</option>
                                <option value="cs">捷克语 (cs)</option>
                                <option value="el">希腊语 (el)</option>
                                <option value="ro">罗马尼亚语 (ro)</option>
                                <option value="da">丹麦语 (da)</option>
                                <option value="fi">芬兰语 (fi)</option>
                                <option value="sv">瑞典语 (sv)</option>
                                <option value="no">挪威语 (no)</option>
                                <option value="hu">匈牙利语 (hu)</option>
                                <option value="he">希伯来语 (he)</option>
                                <option value="fa">波斯语 (fa)</option>
                                <option value="bn">孟加拉语 (bn)</option>
                                <option value="ta">泰米尔语 (ta)</option>
                                <option value="te">泰卢固语 (te)</option>
                                <option value="mr">马拉地语 (mr)</option>
                                <option value="gu">古吉拉特语 (gu)</option>
                                <option value="kn">卡纳达语 (kn)</option>
                                <option value="ml">马拉雅拉姆语 (ml)</option>
                                <option value="pa">旁遮普语 (pa)</option>
                                <option value="ur">乌尔都语 (ur)</option>
                                <option value="af">南非荷兰语 (af)</option>
                                <option value="sq">阿尔巴尼亚语 (sq)</option>
                                <option value="az">阿塞拜疆语 (az)</option>
                                <option value="eu">巴斯克语 (eu)</option>
                                <option value="be">白俄罗斯语 (be)</option>
                                <option value="bs">波斯尼亚语 (bs)</option>
                                <option value="bg">保加利亚语 (bg)</option>
                                <option value="ca">加泰罗尼亚语 (ca)</option>
                                <option value="hr">克罗地亚语 (hr)</option>
                                <option value="et">爱沙尼亚语 (et)</option>
                                <option value="gl">加利西亚语 (gl)</option>
                                <option value="kk">哈萨克语 (kk)</option>
                                <option value="lv">拉脱维亚语 (lv)</option>
                                <option value="lt">立陶宛语 (lt)</option>
                                <option value="mk">马其顿语 (mk)</option>
                                <option value="ms">马来语 (ms)</option>
                                <option value="sr">塞尔维亚语 (sr)</option>
                                <option value="sk">斯洛伐克语 (sk)</option>
                                <option value="sl">斯洛文尼亚语 (sl)</option>
                                <option value="sw">斯瓦希里语 (sw)</option>
                                <option value="tl">他加禄语 (tl)</option>
                                <option value="cy">威尔士语 (cy)</option>
                            </select>
                        </div>
                        
                        <div id="twoWayOptions" class="translation-options" style="display: none;">
                            <div class="two-way-container">
                                <div class="lang-group">
                                    <label class="select-label">语言 A:</label>
                                    <select id="langA" class="lang-select">
                                        <option value="en">英语 (en)</option>
                                        <option value="zh">中文 (zh)</option>
                                        <option value="es">西班牙语 (es)</option>
                                        <option value="fr">法语 (fr)</option>
                                        <option value="de">德语 (de)</option>
                                        <option value="ja">日语 (ja)</option>
                                        <option value="ko">韩语 (ko)</option>
                                        <option value="ar">阿拉伯语 (ar)</option>
                                        <option value="ru">俄语 (ru)</option>
                                        <option value="pt">葡萄牙语 (pt)</option>
                                        <option value="it">意大利语 (it)</option>
                                        <option value="nl">荷兰语 (nl)</option>
                                        <option value="pl">波兰语 (pl)</option>
                                        <option value="tr">土耳其语 (tr)</option>
                                        <option value="vi">越南语 (vi)</option>
                                        <option value="th">泰语 (th)</option>
                                        <option value="id">印尼语 (id)</option>
                                        <option value="hi">印地语 (hi)</option>
                                        <option value="uk">乌克兰语 (uk)</option>
                                        <option value="cs">捷克语 (cs)</option>
                                        <option value="el">希腊语 (el)</option>
                                        <option value="ro">罗马尼亚语 (ro)</option>
                                        <option value="da">丹麦语 (da)</option>
                                        <option value="fi">芬兰语 (fi)</option>
                                        <option value="sv">瑞典语 (sv)</option>
                                        <option value="no">挪威语 (no)</option>
                                        <option value="hu">匈牙利语 (hu)</option>
                                        <option value="he">希伯来语 (he)</option>
                                        <option value="fa">波斯语 (fa)</option>
                                        <option value="bn">孟加拉语 (bn)</option>
                                        <option value="ta">泰米尔语 (ta)</option>
                                        <option value="te">泰卢固语 (te)</option>
                                        <option value="mr">马拉地语 (mr)</option>
                                        <option value="gu">古吉拉特语 (gu)</option>
                                        <option value="kn">卡纳达语 (kn)</option>
                                        <option value="ml">马拉雅拉姆语 (ml)</option>
                                        <option value="pa">旁遮普语 (pa)</option>
                                        <option value="ur">乌尔都语 (ur)</option>
                                        <option value="af">南非荷兰语 (af)</option>
                                        <option value="sq">阿尔巴尼亚语 (sq)</option>
                                        <option value="az">阿塞拜疆语 (az)</option>
                                        <option value="eu">巴斯克语 (eu)</option>
                                        <option value="be">白俄罗斯语 (be)</option>
                                        <option value="bs">波斯尼亚语 (bs)</option>
                                        <option value="bg">保加利亚语 (bg)</option>
                                        <option value="ca">加泰罗尼亚语 (ca)</option>
                                        <option value="hr">克罗地亚语 (hr)</option>
                                        <option value="et">爱沙尼亚语 (et)</option>
                                        <option value="gl">加利西亚语 (gl)</option>
                                        <option value="kk">哈萨克语 (kk)</option>
                                        <option value="lv">拉脱维亚语 (lv)</option>
                                        <option value="lt">立陶宛语 (lt)</option>
                                        <option value="mk">马其顿语 (mk)</option>
                                        <option value="ms">马来语 (ms)</option>
                                        <option value="sr">塞尔维亚语 (sr)</option>
                                        <option value="sk">斯洛伐克语 (sk)</option>
                                        <option value="sl">斯洛文尼亚语 (sl)</option>
                                        <option value="sw">斯瓦希里语 (sw)</option>
                                        <option value="tl">他加禄语 (tl)</option>
                                        <option value="cy">威尔士语 (cy)</option>
                                    </select>
                                </div>
                                <span class="arrow">↔</span>
                                <div class="lang-group">
                                    <label class="select-label">语言 B:</label>
                                    <select id="langB" class="lang-select">
                                        <option value="zh">中文 (zh)</option>
                                        <option value="en">英语 (en)</option>
                                        <option value="es">西班牙语 (es)</option>
                                        <option value="fr">法语 (fr)</option>
                                        <option value="de">德语 (de)</option>
                                        <option value="ja">日语 (ja)</option>
                                        <option value="ko">韩语 (ko)</option>
                                        <option value="ar">阿拉伯语 (ar)</option>
                                        <option value="ru">俄语 (ru)</option>
                                        <option value="pt">葡萄牙语 (pt)</option>
                                        <option value="it">意大利语 (it)</option>
                                        <option value="nl">荷兰语 (nl)</option>
                                        <option value="pl">波兰语 (pl)</option>
                                        <option value="tr">土耳其语 (tr)</option>
                                        <option value="vi">越南语 (vi)</option>
                                        <option value="th">泰语 (th)</option>
                                        <option value="id">印尼语 (id)</option>
                                        <option value="hi">印地语 (hi)</option>
                                        <option value="uk">乌克兰语 (uk)</option>
                                        <option value="cs">捷克语 (cs)</option>
                                        <option value="el">希腊语 (el)</option>
                                        <option value="ro">罗马尼亚语 (ro)</option>
                                        <option value="da">丹麦语 (da)</option>
                                        <option value="fi">芬兰语 (fi)</option>
                                        <option value="sv">瑞典语 (sv)</option>
                                        <option value="no">挪威语 (no)</option>
                                        <option value="hu">匈牙利语 (hu)</option>
                                        <option value="he">希伯来语 (he)</option>
                                        <option value="fa">波斯语 (fa)</option>
                                        <option value="bn">孟加拉语 (bn)</option>
                                        <option value="ta">泰米尔语 (ta)</option>
                                        <option value="te">泰卢固语 (te)</option>
                                        <option value="mr">马拉地语 (mr)</option>
                                        <option value="gu">古吉拉特语 (gu)</option>
                                        <option value="kn">卡纳达语 (kn)</option>
                                        <option value="ml">马拉雅拉姆语 (ml)</option>
                                        <option value="pa">旁遮普语 (pa)</option>
                                        <option value="ur">乌尔都语 (ur)</option>
                                        <option value="af">南非荷兰语 (af)</option>
                                        <option value="sq">阿尔巴尼亚语 (sq)</option>
                                        <option value="az">阿塞拜疆语 (az)</option>
                                        <option value="eu">巴斯克语 (eu)</option>
                                        <option value="be">白俄罗斯语 (be)</option>
                                        <option value="bs">波斯尼亚语 (bs)</option>
                                        <option value="bg">保加利亚语 (bg)</option>
                                        <option value="ca">加泰罗尼亚语 (ca)</option>
                                        <option value="hr">克罗地亚语 (hr)</option>
                                        <option value="et">爱沙尼亚语 (et)</option>
                                        <option value="gl">加利西亚语 (gl)</option>
                                        <option value="kk">哈萨克语 (kk)</option>
                                        <option value="lv">拉脱维亚语 (lv)</option>
                                        <option value="lt">立陶宛语 (lt)</option>
                                        <option value="mk">马其顿语 (mk)</option>
                                        <option value="ms">马来语 (ms)</option>
                                        <option value="sr">塞尔维亚语 (sr)</option>
                                        <option value="sk">斯洛伐克语 (sk)</option>
                                        <option value="sl">斯洛文尼亚语 (sl)</option>
                                        <option value="sw">斯瓦希里语 (sw)</option>
                                        <option value="tl">他加禄语 (tl)</option>
                                        <option value="cy">威尔士语 (cy)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Language Hints -->
                    <div class="language-hints-section" style="margin: 20px 0; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px;">
                        <h4 style="color: white;">🌍 语言提示（可显著提高准确率）</h4>
                        <p class="hint" style="color: rgba(255,255,255,0.7); font-size: 13px; margin-bottom: 10px;">勾选可能出现的语言，不选则自动检测所有语言</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin-top: 10px;">
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="zh" checked>
                                <span class="slider"></span>
                                <span class="label-text">中文 (zh)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="en" checked>
                                <span class="slider"></span>
                                <span class="label-text">英语 (en)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="ja">
                                <span class="slider"></span>
                                <span class="label-text">日语 (ja)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="ko">
                                <span class="slider"></span>
                                <span class="label-text">韩语 (ko)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="es">
                                <span class="slider"></span>
                                <span class="label-text">西班牙语 (es)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="fr">
                                <span class="slider"></span>
                                <span class="label-text">法语 (fr)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="de">
                                <span class="slider"></span>
                                <span class="label-text">德语 (de)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="ru">
                                <span class="slider"></span>
                                <span class="label-text">俄语 (ru)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="pt">
                                <span class="slider"></span>
                                <span class="label-text">葡萄牙语 (pt)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="ar">
                                <span class="slider"></span>
                                <span class="label-text">阿拉伯语 (ar)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="it">
                                <span class="slider"></span>
                                <span class="label-text">意大利语 (it)</span>
                            </label>
                            <label class="switch" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="ws-lang-hint" value="hi">
                                <span class="slider"></span>
                                <span class="label-text">印地语 (hi)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Context 编辑器 -->
                    <div class="context-section" style="margin: 20px 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4 style="margin: 0; color: white;">📝 Context（上下文配置）</h4>
                            <div>
                                <button id="saveContextTemplate" class="btn-small" style="margin-right: 5px;">💾 保存模板</button>
                                <button id="loadContextTemplate" class="btn-small">📂 加载模板</button>
                            </div>
                        </div>
                        <p class="hint" style="color: rgba(255,255,255,0.7); font-size: 13px; margin-bottom: 15px;">提供上下文信息可大幅提高识别准确率（最多 8000 tokens）</p>
                        
                        <!-- General 部分 -->
                        <details open style="margin-bottom: 15px;">
                            <summary style="cursor: pointer; font-weight: 600; color: white; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">1️⃣ General（结构化信息）</summary>
                            <div style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 4px; margin-top: 10px;">
                                <p class="hint" style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 10px;">例如：domain=Healthcare, topic=Diabetes consultation</p>
                                <div id="contextGeneralList"></div>
                                <div style="display: flex; gap: 10px; margin-top: 10px;">
                                    <input type="text" id="contextGeneralKey" placeholder="Key (如: domain)" style="flex: 1; padding: 8px; border-radius: 4px;">
                                    <input type="text" id="contextGeneralValue" placeholder="Value (如: Healthcare)" style="flex: 2; padding: 8px; border-radius: 4px;">
                                    <button id="addContextGeneral" class="btn-small">➕ 添加</button>
                                </div>
                            </div>
                        </details>

                        <!-- Text 部分 -->
                        <details style="margin-bottom: 15px;">
                            <summary style="cursor: pointer; font-weight: 600; color: white; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">2️⃣ Text（背景文本）</summary>
                            <div style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 4px; margin-top: 10px;">
                                <p class="hint" style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 10px;">提供历史记录、会议纪要、相关文档等背景信息</p>
                                <textarea id="contextText" placeholder="输入背景文本..." style="width: 100%; min-height: 100px; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 13px;"></textarea>
                            </div>
                        </details>

                        <!-- Terms 部分 -->
                        <details style="margin-bottom: 15px;">
                            <summary style="cursor: pointer; font-weight: 600; color: white; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">3️⃣ Terms（专业术语）</summary>
                            <div style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 4px; margin-top: 10px;">
                                <p class="hint" style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 10px;">例如：Metformin, HbA1c, Glucometer（每行一个）</p>
                                <div id="contextTermsList" style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px; min-height: 30px;"></div>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="contextTermInput" placeholder="输入术语，回车添加" style="flex: 1; padding: 8px; border-radius: 4px;">
                                    <button id="addContextTerm" class="btn-small">➕ 添加</button>
                                </div>
                            </div>
                        </details>

                        <!-- Translation Terms 部分 -->
                        <details style="margin-bottom: 15px;">
                            <summary style="cursor: pointer; font-weight: 600; color: white; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">4️⃣ Translation Terms（翻译对照）</summary>
                            <div style="padding: 15px; background: rgba(255,255,255,0.05); border-radius: 4px; margin-top: 10px;">
                                <p class="hint" style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 10px;">自定义特定词汇的翻译方式</p>
                                <div id="contextTranslationList"></div>
                                <div style="display: flex; gap: 10px; margin-top: 10px;">
                                    <input type="text" id="contextTransSource" placeholder="原文 (如: MRI)" style="flex: 1; padding: 8px; border-radius: 4px;">
                                    <span style="color: white; line-height: 36px;">→</span>
                                    <input type="text" id="contextTransTarget" placeholder="译文 (如: RM)" style="flex: 1; padding: 8px; border-radius: 4px;">
                                    <button id="addContextTranslation" class="btn-small">➕ 添加</button>
                                </div>
                            </div>
                        </details>
                    </div>

                    <div class="audio-source-section">
                        <h4>🎤 音频来源</h4>
                        <div class="translation-mode">
                            <label class="radio-option">
                                <input type="radio" name="audioSource" value="microphone" checked>
                                <span class="radio-label">🎤 麦克风录音</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="audioSource" value="file">
                                <span class="radio-label">📁 上传文件</span>
                            </label>
                        </div>
                        <div id="fileUploadSection" style="display: none; margin-top: 15px;">
                            <input type="file" id="wsFile" accept="audio/*,video/*" style="padding: 10px; background: white; border-radius: 8px; width: 100%;">
                        </div>
                    </div>

                    <button id="wsStartBtn" class="btn btn-primary">🎤 开始录音</button>
                    <button id="wsStopBtn" class="btn btn-danger" style="display: none;">⏹️ 停止录音</button>
                    <button id="wsFinalizeBtn" class="btn btn-warning" style="display: none; margin-left: 10px;">⚡ 立即终结</button>

                    <div id="wsStatus" style="display: none; padding: 15px; border-radius: 8px; margin-top: 15px;"></div>
                </div>

                <div class="transcript-box">
                    <h3>实时转录结果</h3>
                    <div id="wsResult" style="background: white; padding: 15px; border-radius: 8px; min-height: 300px; max-height: 600px; overflow-y: auto; border: 2px solid #4CAF50; font-size: 14px; line-height: 1.5;"></div>
                    <div style="margin-top: 10px; display: flex; gap: 10px;">
                        <button id="wsDownloadBtn" class="btn btn-success" style="display: none;">💾 下载转录结果</button>
                        <button id="wsCopyBtn" class="btn btn-primary" onclick="copyWsResult()">📋 复制内容</button>
                        <button id="wsClearResult" class="btn btn-danger">🗑️ 清空内容</button>
                    </div>
                </div>

                <div class="log-box">
                    <h3>📋 处理日志 <button id="wsClearLog" class="btn-small">清空</button></h3>
                    <div id="wsLog"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js?v=20260214"></script>
    <script>
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }
    </script>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="star-cta">
            <div class="star-icon">⭐</div>
            <h3>给我们一个 Star！</h3>
            <p>如果这个项目对你有帮助，请在 GitHub 上支持我们</p>
            <div class="star-actions">
                <a href="https://github.com/neosun100/soniox-asr-web" target="_blank" class="action-btn primary">
                    <span class="btn-icon">⭐</span>
                    <span class="btn-text">Star 项目</span>
                </a>
                <a href="https://github.com/neosun100/soniox-asr-web/issues" target="_blank" class="action-btn">
                    <span class="btn-icon">🐛</span>
                    <span class="btn-text">报告 Bug</span>
                </a>
                <a href="https://github.com/neosun100/soniox-asr-web/issues" target="_blank" class="action-btn">
                    <span class="btn-icon">✨</span>
                    <span class="btn-text">新功能</span>
                </a>
            </div>
        </div>
        <div class="footer-divider"></div>
        <p class="footer-text">Made with ❤️ by <a href="https://github.com/neosun100" target="_blank">Neo Sun</a></p>
    </footer>
</body>
</html>
